<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
        #bke {
            width:330px;
            height:330px;
        }
        .field {
            width:100px;
            height:100px;
            float:left;
            border-style: solid;
            border-width: 5px;
            cursor:pointer;
            font-family:Arial;
            padding:30px;
            padding-top:20px;
            font-size:40px;
            box-sizing:border-box;
        }
    </style>
</head>
<body>
    <div id="bke">
        <div id="00" class="field" onclick="bkeClick(this)"></div>
        <div id="01" class="field" onclick="bkeClick(this)"></div>
        <div id="02" class="field" onclick="bkeClick(this)"></div>
        <div id="10" class="field" onclick="bkeClick(this)"></div>
        <div id="11" class="field" onclick="bkeClick(this)"></div>
        <div id="12" class="field" onclick="bkeClick(this)"></div>
        <div id="20" class="field" onclick="bkeClick(this)"></div>
        <div id="21" class="field" onclick="bkeClick(this)"></div>
        <div id="22" class="field" onclick="bkeClick(this)"></div>
    </div>
    <ul id="messages"></ul>
    <script src="http://192.168.2.175:3000/socket.io/socket.io.js"></script>
    <script>
        var lh = location.hash.split('#')[1];
        var lhValues = lh.split('&');
        var room = lhValues[1];
        var game = lhValues[0];
        var socket = io('http://192.168.2.175:3000');
        console.log(game);
        socket.emit('set game', game);
        console.log(room);
        socket.emit('join room', room);
        socket.on('game msg', function(msg){
            var node = document.createElement("LI");
            var textnode = document.createTextNode(msg);    
            node.appendChild(textnode);                
            document.getElementById('messages').appendChild(node);
            document.getElementById(msg).style.backgroundColor = "green";
        });
        socket.on('game state', function(gamestate){
            var nodes = document.getElementById("bke").childNodes;
            for(i=1;i<(nodes.length);i=i+2) {
                var y = nodes[i].id;
                if(gamestate[y[0]][y[1]]){
                    document.getElementById(y).innerHTML = gamestate[y[0]][y[1]]
                } else {
                    document.getElementById(y).innerHTML = "";
                }
            }
        });
        function bkeClick(x) {
            var id = x.id;
            socket.emit('game input', id)
        };
    </script>
</body>
</html>